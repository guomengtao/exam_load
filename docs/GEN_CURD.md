 å®Œæ•´æ–¹æ¡ˆçš„æ–‡æ¡£æ•´ç†ï¼ˆæ— ä»£ç ç‰ˆæœ¬ï¼‰ï¼Œé‡ç‚¹è¯´æ˜æ¯ä¸ªæ–‡ä»¶ã€è·¯å¾„åŠèŒè´£ã€‚è¯¥æ–¹æ¡ˆé‡‡ç”¨ï¼š

âœ… Gorm
âœ… æ¥å£åŸºç¡€5ä¸ªï¼šå¢åˆ æ”¹æŸ¥ + æœç´¢
âœ… æµ‹è¯•ç”¨è¡¨åŠ  _test åç¼€ï¼ŒåŒåº“éš”ç¦»æµ‹è¯•æ•°æ®
âœ… è‡ªåŠ¨ç”Ÿæˆ Swag æ–‡æ¡£ + å•å…ƒæµ‹è¯• + æ¥å£æµ‹è¯•æ¨¡æ¿

â¸»

ğŸ“˜ é¡¹ç›®è§„èŒƒæ–¹æ¡ˆæ–‡æ¡£ï¼šåŸºäº Gorm çš„ CRUD æ¥å£ç”Ÿæˆä½“ç³»

ğŸ’¡ æ–¹æ¡ˆæ¦‚è¿°

æœ¬æ–¹æ¡ˆæ—¨åœ¨ä¸ºæ¯ä¸ªæ•°æ®åº“è¡¨ç”Ÿæˆä¸€å¥—å®Œæ•´çš„ã€å¯ç»´æŠ¤çš„ REST API æ¥å£ï¼ŒåŒ…å«ï¼š
	â€¢	5 ä¸ªæ ¸å¿ƒæ¥å£ï¼ˆå¢ã€åˆ ã€æ”¹ã€æŸ¥ã€æœç´¢ï¼‰
	â€¢	Swag è‡ªåŠ¨æ–‡æ¡£
	â€¢	æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆHTTPï¼‰
	â€¢	å•å…ƒæµ‹è¯•ï¼ˆService å±‚ï¼‰
	â€¢	æµ‹è¯•è¡¨é‡‡ç”¨åŒåº“ã€åŒç»“æ„ï¼Œè¡¨ååŠ  _test åç¼€
	â€¢	åŸºäº Gorm è‡ªåŠ¨è¿ç§»èƒ½åŠ›ï¼Œè‡ªåŠ¨ç”Ÿæˆè¡¨ç»“æ„

â¸»

ğŸ“ ç›®å½•ç»“æ„

app/
â”œâ”€â”€ controllers/        // æ§åˆ¶å™¨ï¼ˆæ¥å£å¤„ç†ï¼‰
â”‚   â”œâ”€â”€ member_controller.go
â”‚   â””â”€â”€ member_controller_test.go       # æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•
â”œâ”€â”€ models/             // æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ member.go
â”‚   â””â”€â”€ member_test.go                  # æµ‹è¯•æ¨¡å‹ï¼ˆä½¿ç”¨ _test è¡¨ï¼‰
â”œâ”€â”€ services/           // ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ member_service.go
â”‚   â””â”€â”€ member_service_test.go          # å•å…ƒæµ‹è¯•
scripts/
â””â”€â”€ gen_crud.go         # è‡ªåŠ¨ç”Ÿæˆ CLI å·¥å…·
docs/
â””â”€â”€ swagger.yaml        # è‡ªåŠ¨ç”Ÿæˆçš„ Swagger æ–‡æ¡£



â¸»

ğŸ“Œ å„æ¨¡å—è¯´æ˜

1. models/member.go
	â€¢	å®šä¹‰æ­£å¼è¡¨ tm_member çš„ç»“æ„
	â€¢	æä¾› Gorm æ¨¡å‹å®šä¹‰
	â€¢	ä½¿ç”¨ TableName() è®¾ç½®è¡¨å‰ç¼€

â¸»

2. models/member_test.go
	â€¢	å®šä¹‰æµ‹è¯•ç”¨è¡¨ tm_member_test çš„ç»“æ„
	â€¢	åŒæ­¥æ¨¡å‹ç»“æ„ï¼Œç”¨äºå•å…ƒæµ‹è¯•æ—¶è‡ªåŠ¨è¿ç§»
	â€¢	ä½¿ç”¨ TableName() æŒ‡å‘ _test åç¼€è¡¨

â¸»

3. services/member_service.go
	â€¢	å°è£…ä¸šåŠ¡é€»è¾‘
	â€¢	é€šå¸¸åŒ…å«ï¼šæŸ¥è¯¢åˆ—è¡¨ã€æœç´¢åˆ†é¡µã€æ–°å¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ–¹æ³•

â¸»

4. services/member_service_test.go
	â€¢	å•å…ƒæµ‹è¯•æ–‡ä»¶
	â€¢	ä½¿ç”¨ _test è¡¨æ“ä½œ
	â€¢	æµ‹è¯•æœåŠ¡å±‚é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œå¦‚å­—æ®µæ ¡éªŒã€æ•°æ®ç»“æ„ã€è¿”å›å€¼ç­‰

â¸»

5. controllers/member_controller.go
	â€¢	æ¥æ”¶è¯·æ±‚ â†’ è°ƒç”¨æœåŠ¡é€»è¾‘ â†’ è¿”å› JSON å“åº”
	â€¢	åŒ…æ‹¬ 5 ä¸ªåŸºæœ¬æ¥å£ï¼š
	â€¢	GET /member/list
	â€¢	POST /member/create
	â€¢	PUT /member/update/:id
	â€¢	DELETE /member/delete/:id
	â€¢	POST /member/search

â¸»

6. controllers/member_controller_test.go
	â€¢	ä½¿ç”¨ httptest.NewRecorder() å‘èµ·çœŸå® HTTP è¯·æ±‚
	â€¢	æ–­è¨€å“åº”ç»“æœï¼Œé€‚åˆ CI è‡ªåŠ¨åŒ–æµ‹è¯•
	â€¢	æµ‹è¯• API å±‚è¿”å›ç»“æ„å’Œè·¯ç”±æ­£ç¡®æ€§

â¸»

7. scripts/gen_crud.go
	â€¢	å‘½ä»¤è¡Œå·¥å…·ï¼šè‡ªåŠ¨ç”ŸæˆæŒ‡å®šè¡¨çš„ CRUD å…¨å¥—ç»“æ„
	â€¢	ç”¨æ³•ï¼š

go run scripts/gen_crud.go --table=member



â¸»

8. docs/swagger.yaml
	â€¢	é€šè¿‡ swag init è‡ªåŠ¨ç”Ÿæˆ
	â€¢	æ¥å£æ³¨é‡Šè§„èŒƒç»Ÿä¸€ç”± controllers/member_controller.go ä¸­ç»´æŠ¤
	â€¢	æ”¯æŒåœ¨çº¿æ–‡æ¡£ã€è‡ªåŠ¨ Try it out æ¥å£æµ‹è¯•

â¸»

ğŸ§ª æµ‹è¯•æœºåˆ¶è¯´æ˜

âœ… æµ‹è¯•è¡¨è®¾è®¡ï¼ˆæ¨èï¼‰
	â€¢	åœ¨ .env æ–‡ä»¶è®¾ç½®å‰ç¼€ï¼šTABLE_PREFIX=tm_
	â€¢	æµ‹è¯•æ—¶é€šè¿‡æ¨¡å‹ TableName() è‡ªåŠ¨æ‹¼æ¥ä¸º tm_member_test
	â€¢	ä½¿ç”¨ gorm.AutoMigrate() è‡ªåŠ¨åˆ›å»ºæµ‹è¯•è¡¨
	â€¢	æµ‹è¯•æ•°æ®å†™å…¥åè‡ªåŠ¨æ¸…ç†ï¼ˆå»ºè®®ï¼‰

â¸»

âœ… å•å…ƒæµ‹è¯•è¿è¡Œæ–¹å¼

go test ./app/services -v

âœ… æ¥å£æµ‹è¯•è¿è¡Œæ–¹å¼

go test ./app/controllers -v



â¸»

ğŸ æ€»ç»“ï¼šæ–¹æ¡ˆä¼˜åŠ¿

ç‰¹æ€§	æè¿°
æ¥å£æ ‡å‡†åŒ–	æ¯å¼ è¡¨ç”Ÿæˆç»“æ„ä¸€è‡´çš„æ¥å£ä¸æ–‡æ¡£
æµ‹è¯•éš”ç¦»å®‰å…¨	_test è¡¨æ•°æ®ä¸æ±¡æŸ“æ­£å¼æ•°æ®
é«˜åº¦å¯ç»´æŠ¤	æ¥å£ã€æ¨¡å‹ã€æœåŠ¡å±‚èŒè´£åˆ†æ˜
è‡ªåŠ¨ç”Ÿæˆèƒ½åŠ›	CLI å·¥å…·å¿«é€Ÿç”Ÿæˆå®Œæ•´ç»“æ„
Swag + æµ‹è¯•åŒæ”¯æŒ	ä¸€é”®æ–‡æ¡£ + è‡ªåŠ¨åŒ–æµ‹è¯•



 
---

## ğŸ” è·¯ç”±ç”Ÿæˆè¯´æ˜

æœ¬æ–¹æ¡ˆè¿˜æ”¯æŒè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„è·¯ç”±æ³¨å†Œä»£ç ã€‚

### ğŸ“„ è·¯ç”±ç”Ÿæˆæ ¼å¼ï¼ˆä»¥ member ä¸ºä¾‹ï¼‰ï¼š

```go
r.GET("/member/list", controllers.GetMemberList)
r.POST("/member/create", controllers.CreateMember)
r.PUT("/member/update/:id", controllers.UpdateMember)
r.DELETE("/member/delete/:id", controllers.DeleteMember)
r.POST("/member/search", controllers.SearchMember)
```

è¿™äº›ä»£ç å°†è‡ªåŠ¨å†™å…¥ï¼š

```
routes/
â””â”€â”€ auto_routes.go
```

æˆ–è¿½åŠ åˆ°ç»Ÿä¸€çš„ `routes.go` ä¸­ã€‚

### âœ… è‡ªåŠ¨è·¯ç”±æ³¨å†Œæ–¹æ¡ˆ

- ä½¿ç”¨ `scripts/gen_crud.go` å·¥å…·è‡ªåŠ¨è¿½åŠ è·¯ç”±ä»£ç ã€‚
- å¯æ ¹æ®æ¨¡æ¿åŠ¨æ€æ‹¼æ¥æ§åˆ¶å™¨å‡½æ•°åä¸è·¯å¾„ã€‚
- ä¿æŒç»Ÿä¸€å‘½åè§„èŒƒï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚

---

## ğŸ› ï¸ è‡ªåŠ¨ç”Ÿæˆå‰çš„å‡†å¤‡å·¥ä½œ

è¯·å‡†å¤‡ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **è¡¨åï¼ˆå¦‚ `member`ï¼‰**
2. **æ•°æ®åº“å­—æ®µç»“æ„**ï¼š
   - å­—æ®µåï¼ˆå¦‚ `username`, `email`ï¼‰
   - å­—æ®µç±»å‹ï¼ˆå¦‚ `string`, `int`, `time.Time`ï¼‰
   - æ˜¯å¦ä¸ºä¸»é”®ã€è‡ªå¢ã€nullable ç­‰å±æ€§
3. **å¯é€‰é¡¹**ï¼š
   - æ˜¯å¦éœ€è¦è½¯åˆ é™¤æ”¯æŒ
   - æ˜¯å¦åŒ…å« created_at / updated_at ç­‰æ ‡å‡†å­—æ®µ

---

## ğŸ§  è‡ªåŠ¨è¿ç§»è¯´æ˜ï¼ˆGormï¼‰

è‡ªåŠ¨è¿ç§»æ˜¯ Gorm çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒå°†æ¨¡å‹ç»“æ„åŒæ­¥åˆ°æ•°æ®åº“è¡¨ç»“æ„ï¼š

### âœ¨ æ”¯æŒçš„åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| è‡ªåŠ¨åˆ›å»ºè¡¨ | æ ¹æ®æ¨¡å‹è‡ªåŠ¨åˆ›å»ºæ–°è¡¨ |
| è¡¥å……å­—æ®µ | æ–°å¢å­—æ®µå°†è‡ªåŠ¨åŒæ­¥åˆ°æ•°æ®åº“ |
| è‡ªåŠ¨ç´¢å¼• | æ ¹æ® tag è‡ªåŠ¨åˆ›å»ºç´¢å¼• |
| è‡ªåŠ¨è®¾ç½®å­—æ®µç±»å‹ | è‡ªåŠ¨åŒ¹é…åˆé€‚çš„æ•°æ®åº“å­—æ®µç±»å‹ |
| å­—æ®µæ›´æ–° | ä¿®æ”¹ tag åå­—æ®µå±æ€§æ›´æ–°ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ |

### âš ï¸ æ³¨æ„äº‹é¡¹

- **å­—æ®µåˆ é™¤ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œ**ï¼Œé˜²æ­¢è¯¯åˆ æ•°æ®ã€‚
- è‹¥å­—æ®µç±»å‹ä¿®æ”¹ï¼Œå¯èƒ½ä¸ä¼šå®Œå…¨åŒæ­¥ï¼Œéœ€æ‰‹åŠ¨è¿ç§»ã€‚
- æ›´å¤æ‚çš„å­—æ®µå˜æ›´å»ºè®®æ‰‹å†™ migration è„šæœ¬ã€‚
- å¯æ­é… `gormigrate` ç­‰åº“è¿›è¡Œç‰ˆæœ¬åŒ–è¿ç§»ç®¡ç†ã€‚

---

ä¸‹é¢æ˜¯å¯¹ä½ æ–‡æ¡£ä¸­æåˆ°çš„ gen_crud.go CLI å·¥å…·çš„å®Œæ•´ç”Ÿæˆç»†èŠ‚è®¾è®¡å’Œå»ºè®®æ–¹æ¡ˆï¼Œé€‚åˆä½œä¸ºæ–‡æ¡£çš„â€œç”Ÿæˆå™¨å®ç°è¯´æ˜â€ç« èŠ‚ï¼š

â¸»

ğŸ”§ CLI å·¥å…·ç”Ÿæˆç»†èŠ‚è¯´æ˜ï¼ˆgen_crud.goï¼‰

ğŸ“Œ ç›®æ ‡

æ‰§è¡Œå‘½ä»¤ï¼š

go run scripts/gen_crud.go --table=member

è‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹å†…å®¹ï¼š
	â€¢	GORM æ¨¡å‹æ–‡ä»¶ï¼ˆå« _test ç‰ˆæœ¬ï¼‰
	â€¢	Service å±‚ä»£ç å’Œæµ‹è¯•ä»£ç 
	â€¢	Controller å±‚æ¥å£å’Œæ¥å£æµ‹è¯•ä»£ç 
	â€¢	Swag æ³¨é‡Šè‡ªåŠ¨æ³¨å…¥
	â€¢	è·¯ç”±æ³¨å†Œä»£ç è‡ªåŠ¨è¿½åŠ 
	â€¢	Swag æ–‡æ¡£é‡æ–°ç”Ÿæˆï¼ˆå¯é€‰ï¼‰

â¸»

ğŸ§± æ–‡ä»¶ç»“æ„æ¨¡æ¿è¯´æ˜

âœ… æ–‡ä»¶è·¯å¾„è§„åˆ™ï¼ˆæ ¹æ®è¡¨å memberï¼‰ï¼š

å±‚	è·¯å¾„å’Œæ–‡ä»¶	æ–‡ä»¶ä½œç”¨
Model	app/models/member.go	GORM æ¨¡å‹å®šä¹‰
	app/models/member_test.go	_test æµ‹è¯•è¡¨æ¨¡å‹
Service	app/services/member_service.go	CRUD é€»è¾‘å‡½æ•°
	app/services/member_service_test.go	å•å…ƒæµ‹è¯•é€»è¾‘
Controller	app/controllers/member_controller.go	æ¥å£å®šä¹‰å’Œæ³¨é‡Š
	app/controllers/member_controller_test.go	æ¥å£æµ‹è¯•
Route	routes/auto_routes.go	è‡ªåŠ¨è¿½åŠ è·¯ç”±



â¸»

âœï¸ CLI å·¥å…·ç”Ÿæˆæµç¨‹

1. è§£æå‚æ•°

table := flag.String("table", "", "æ•°æ®åº“è¡¨åï¼ˆä¸å«å‰ç¼€ï¼‰")

2. æ¨¡æ¿æ¸²æŸ“
	â€¢	ä½¿ç”¨ text/template æ¨¡æ¿å¼•æ“ã€‚
	â€¢	æ¨¡æ¿æ–‡ä»¶å»ºè®®æ”¾åœ¨ scripts/templates/ ç›®å½•ä¸­ï¼Œæ”¯æŒå¯è‡ªå®šä¹‰ä¿®æ”¹ã€‚

æ¨¡æ¿æ–‡ä»¶	å¯¹åº”ç”Ÿæˆç›®æ ‡æ–‡ä»¶
model.tmpl	models/{{.Table}}.go
model_test.tmpl	models/{{.Table}}_test.go
service.tmpl	services/{{.Table}}_service.go
service_test.tmpl	services/{{.Table}}_service_test.go
controller.tmpl	controllers/{{.Table}}_controller.go
controller_test.tmpl	controllers/{{.Table}}_controller_test.go
route_append.tmpl	è¿½åŠ åˆ° routes/auto_routes.go

3. å‘½åè½¬æ¢è§„åˆ™

åŸå§‹å€¼	ç¤ºä¾‹	è½¬æ¢ç»“æœ
è¡¨å	member	ç±»å Member
å­—æ®µå	user_id	Go å­—æ®µå UserID



â¸»

ğŸ“œ è‡ªåŠ¨è¿½åŠ è·¯ç”±çš„è§„åˆ™
	â€¢	è¿½åŠ åˆ° routes/auto_routes.goï¼Œæˆ–ç»Ÿä¸€æ³¨å†Œå‡½æ•°ä¸­ã€‚
	â€¢	é‡‡ç”¨ AppendFile() æ–¹å¼å‘æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹ï¼š

r.GET("/member/list", controllers.GetMemberList)
r.POST("/member/create", controllers.CreateMember)
r.PUT("/member/update/:id", controllers.UpdateMember)
r.DELETE("/member/delete/:id", controllers.DeleteMember)
r.POST("/member/search", controllers.SearchMember)



â¸»

ğŸ§¼ ç”Ÿæˆåå»ºè®®æ“ä½œ
	â€¢	âœ… è‡ªåŠ¨æ‰§è¡Œ swag initï¼Œç”Ÿæˆæ›´æ–°çš„ Swagger æ–‡æ¡£ã€‚
	â€¢	âœ… è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•æˆ–æ¥å£æµ‹è¯•éªŒè¯ç”Ÿæˆç»“æœï¼ˆå¯é…ç½®ï¼‰ã€‚
	â€¢	âœ… å¯åŠ ä¸Šç”Ÿæˆåè¾“å‡ºæŒ‡å¼•è·¯å¾„ä¸â€œä¸‹ä¸€æ­¥æ“ä½œæç¤ºâ€ã€‚

â¸»

ğŸ“Œ æ”¯æŒå­—æ®µç»“æ„ï¼ˆåç»­å¯æ‹“å±•ï¼‰

ç›®å‰ä»¥æ‰‹åŠ¨å­—æ®µå®šä¹‰ä¸ºä¸»ï¼Œå¦‚ï¼š

type Member struct {
	ID        uint           `gorm:"primaryKey" json:"id"`
	Username  string         `gorm:"type:varchar(100);not null" json:"username"`
	Email     string         `gorm:"type:varchar(100);unique" json:"email"`
	CreatedAt time.Time      `json:"created_at"`
}

ğŸ‘‰ å¯åç»­æ‹“å±•ä¸ºè‡ªåŠ¨ä»æ•°æ®åº“è¯»å–å­—æ®µç»“æ„ï¼ˆé€šè¿‡ INFORMATION_SCHEMAï¼‰å®ç°æ›´å®Œæ•´çš„è‡ªåŠ¨åŒ–ã€‚

â¸»

âœ¨ æ‹“å±•åŠŸèƒ½å»ºè®®

åŠŸèƒ½	æè¿°
å­—æ®µæ¨¡æ¿å‚æ•°	è‡ªåŠ¨ç”Ÿæˆå­—æ®µç»“æ„
åŒæ­¥ Swag æ³¨é‡Š	åœ¨ controller ä¸­å†™å…¥æ³¨é‡Šç”Ÿæˆæ–‡æ¡£
è¡¨åé©¼å³°è½¬æ¢	ä» member_activity_log â†’ MemberActivityLog
è½¯åˆ é™¤æ”¯æŒ	æ˜¯å¦è‡ªåŠ¨åŠ å…¥ gorm.DeletedAt å­—æ®µ
æŒ‡å®šå­—æ®µé€‰æ‹©	æ”¯æŒå‘½ä»¤è¡ŒæŒ‡å®šç”Ÿæˆå“ªäº›å­—æ®µ



â¸»

æ˜¯å¦éœ€è¦æˆ‘ä¸ºä½ ç”Ÿæˆä¸€å¥— scripts/templates/*.tmpl æ–‡ä»¶å’Œ gen_crud.go æ¡†æ¶ä»£ç ï¼Ÿå¯ä»¥ç«‹åˆ»å¼€å§‹ã€‚

