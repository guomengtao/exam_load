

# 字段更新规则说明（FIELD_UPDATE_POLICY.md）

本规范用于明确接口更新行为中字段的处理规则，避免因字段空值/零值/未传产生逻辑歧义。

---

## ✅ 通用更新规则

- 仅更新请求体中**出现的字段**。
- 请求体中**未出现的字段**，应**不做任何修改**。
- 如果请求体中 `"字段名": ""`，代表**将该字段置空字符串**。
- 如果请求体中 `"字段名": null`，代表**将该字段置为 NULL**（若数据库允许）。
- 若请求体中字段值为 `0`、`false` 等零值，**视为有效更新值，不应跳过**。

---

## 🧩 特别说明

- 不允许根据字段内容是否为 ""、0、null 来决定是否更新。**更新与否完全由字段是否出现决定**。
- 所有字段均应支持被“清空”（传空字符串）或“置空”（传 null）操作，除非业务规则另有规定。
- 任何模糊行为（如是否更新 0、false）应通过业务层文档确认，而非由技术推断。

---

## 🚫 禁止行为

- ❌ 不得默认字段值为 "" 或 null 时不更新。
- ❌ 不得猜测“没传字段”的意图。
- ❌ 不得统一清除所有未传字段为 null。

---

## ✅ 示例

请求体：

```json
{
  "id": 123,
  "name": "",
  "score": 0,
  "nickname": null
}
```

解释：
- name: 设置为空字符串（""）
- score: 设置为 0（有效值）
- nickname: 设置为 NULL
- 其他字段：保持原值，不变

---

## 🔒 安全策略建议

- Controller 层：严格过滤请求体，确认只更新已出现字段。
- Service 层：使用 map 构造更新字段，只传递有更新意图的键值对。
- Biz 层：不做字段更新策略判断，仅传递数据流。

---

## 🧠 维护说明

该文档作为后端接口开发的行为规范，必须在团队内统一遵循。如遇特殊业务场景，需通过补充本规范明确处理方式，避免逻辑猜测。